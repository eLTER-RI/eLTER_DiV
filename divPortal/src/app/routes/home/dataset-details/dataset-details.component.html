<app-loading *ngIf="!datasetDetail"></app-loading>

<div class="card-body pb-1 pt-1" *ngIf="datasetDetail !== undefined">

    <div class="tabs">
        <div class="tab">
            <input type="checkbox" [checked]="datasetDetail.open">
            <label class="tab-label" (click)="openCloseDatasetDetail()">
                <label class="pointer">
                    <em (click)="pinClick(); $event.stopPropagation();" 
                        class="fa-2x mr-2 fas fa-map-marker-alt pinIcon"
                        [ngClass]="{'pinIconActive' : pinActive}">
                    </em>
                        <span *ngIf="datasetDetail?.title && datasetDetail?.title.length > 0"> <b>{{datasetDetail?.title}}</b> </span>
                        <span *ngIf="!datasetDetail?.title || datasetDetail?.title.length == 0"> <b> This dataset currently has no title </b> </span>
                </label>
            </label>
            <div *ngIf="datasetDetail.open" class="tab-content">

                <div [hidden]="!datasetDetail.open" id="detailsTimeseriesScroll"  malihu-scrollbar [scrollbarOptions]="scrollbarOptions" class="mt-0 pt-0">
                    <div class="tabs">
                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'basic'">
                            <label class="tab-label" (click)="clickOnTab('basic')">
                                Basic information
                            </label>
                            <div *ngIf="menuItem == 'basic'" class="tab-content">
                                <div class="h6 text-secundary-color-green-dark mb-0 ml-2"> 
                                    Data level: {{datasetDetail?.metadata?.dataLevel}}
                                </div>
                                <div class="tabs">
                                    <div class="tab" *ngFor="let project of datasetDetail?.metadata?.projects">
                                        <input type="checkbox" [checked]="submenuItem === 'project' + project.name">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('project' + project.name)">
                                            {{project.name}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'project' + project.name">
                                            <div class="h6 text-secundary-color-green-dark mb-0">PID</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{project?.pid}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'creators'">
                            <label class="tab-label" (click)="clickOnTab('creators')">
                                Creators
                            </label>
                            <div *ngIf="menuItem == 'creators'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let creator of datasetDetail?.metadata?.creators" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'creator' + creator.email">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('creator' + creator.email)">
                                            {{creator.givenName}} {{creator?.familyName}} 
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'creator' + creator.email">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Family name</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{creator?.familyName}} 
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Email</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{creator?.email}}
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Given name</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{creator.givenName}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'contributors'">
                            <label class="tab-label" (click)="clickOnTab('contributors')">
                                Contributors
                            </label>
                            <div *ngIf="menuItem == 'contributors'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let contributor of datasetDetail?.metadata?.contributors" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'contributor' + contributor.email">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('contributor' + contributor.email)">
                                            {{contributor.givenName}} {{contributor?.familyName}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'contributor' + contributor.email">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Family name</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{contributor?.familyName}} 
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Email</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{contributor?.email}}
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Given name</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{contributor.givenName}}
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Contributor type</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{contributor.contributorType}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'descriptions'">
                            <label class="tab-label" (click)="clickOnTab('descriptions')">
                                Descriptions
                            </label>
                            <div *ngIf="menuItem == 'descriptions'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let description of datasetDetail?.metadata?.descriptions" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'description' + description.description">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('description' + description.description)">
                                            {{description.description}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'description' + description.description">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Type</div>
                                            <div>{{description?.type}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'keywords'">
                            <label class="tab-label" (click)="clickOnTab('keywords')">
                                Keywords
                            </label>
                            <div *ngIf="menuItem == 'keywords'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let keyword of datasetDetail?.metadata?.keywords" class="tab">
                                        <label class="tab-label no-icon" (click)="navigateToExternal(keyword?.url)">
                                            {{keyword.name}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'licenses'">
                            <label class="tab-label" (click)="clickOnTab('licenses')">
                                Licenses
                            </label>
                            <div *ngIf="menuItem == 'licenses'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let license of datasetDetail?.metadata?.licenses" class="tab">
                                        <label class="tab-label no-icon" (click)="navigateToExternal(license?.url)">
                                            {{license.name}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'taxonomicCoverages'">
                            <label class="tab-label" (click)="clickOnTab('taxonomicCoverages')">
                                Taxonomic coverages
                            </label>
                            <div *ngIf="menuItem == 'taxonomicCoverages'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let taxonomicCoverage of datasetDetail?.metadata?.taxonomicCoverages" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'taxonomicCoverage' + taxonomicCoverage.description">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('taxonomicCoverage' + taxonomicCoverage.description)">
                                            {{taxonomicCoverage.description}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'taxonomicCoverage' + taxonomicCoverage.description">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Taxonomic classification ID</div>
                                            <div>{{taxonomicCoverage?.taxonomicClassification?.taxonomicClassificationID}}</div>
                                            
                                            <div class="h6 text-secundary-color-green-dark mb-0">Taxonomic rank name</div>
                                            <div>{{taxonomicCoverage?.taxonomicClassification?.taxonomicRankName}}</div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Taxonomic rank value</div>
                                            <div>{{taxonomicCoverage?.taxonomicClassification?.taxonomicRankValue}}</div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Taxonomic common name</div>
                                            <div>{{taxonomicCoverage?.taxonomicClassification?.taxonomicCommonName}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'responsibleOrganizations'">
                            <label class="tab-label" (click)="clickOnTab('responsibleOrganizations')">
                                Responsible organizations
                            </label>
                            <div *ngIf="menuItem == 'responsibleOrganizations'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let responsibleOrg of datasetDetail?.metadata?.responsibleOrganizations" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'responsibleOrg' + responsibleOrg.organizationEmail">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('responsibleOrg' + responsibleOrg.organizationEmail)">
                                            {{responsibleOrg.organizationName}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'responsibleOrg' + responsibleOrg.organizationEmail">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Organization email</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{responsibleOrg?.organizationEmail}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'contactPoints'">
                            <label class="tab-label" (click)="clickOnTab('contactPoints')">
                                Contact points
                            </label>
                            <div *ngIf="menuItem == 'contactPoints'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let contactPoint of datasetDetail?.metadata?.contactPoints" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'contactPoint' + contactPoint.contactEmail">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('contactPoint' + contactPoint.contactEmail)">
                                            {{contactPoint.contactName}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'contactPoint' + contactPoint.contactEmail">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Contact email</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{contactPoint?.contactEmail}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'methods'">
                            <label class="tab-label" (click)="clickOnTab('methods')">
                                Methods
                            </label>
                            <div *ngIf="menuItem == 'methods'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let method of datasetDetail?.metadata?.methods" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'method' + method.methodID">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('method' + method.methodID)">
                                            {{method.methodID}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'method' + method.methodID">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Quality control description</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{method?.qualityControlDescription}}
                                            </div>
                                        
                                            <div class="h6 text-secundary-color-green-dark mb-0">Instrumentation description</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{method?.instrumentationDescription}}
                                            </div>

                                            <!-- Sampling -->
                                            <div class="h6 text-secundary-color-green-dark mb-0">Sampling study description</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{method?.sampling?.studyDescription}}
                                            </div>

                                            <div class="h6 text-secundary-color-green-dark mb-0">Sampling description</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{method?.sampling?.samplingDescription}}
                                            </div>
                                        </div>

                                        <!-- Steps -->
                                        <div class="tabs">
                                            <div class="tab" *ngFor="let step of method?.steps">
                                                <input type="checkbox" [checked]="subSubmenuItem === 'step' + step.stepTitle">
                                                <label class="tab-label" (click)="clickOnTabSubSubmenu('step' + step.stepTitle)">
                                                    {{step.stepTitle}}
                                                </label>
                                                <div class="tab-content" *ngIf="subSubmenuItem === 'step' + step.stepTitle">
                                                    <div class="h6 text-secundary-color-green-dark mb-0">Step description</div>
                                                    <div class="mt-0 mb-1"></div>
                                                    <div class="mb-1 mt-0">
                                                        {{step?.stepDescription}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'habitatReferences'">
                            <label class="tab-label" (click)="clickOnTab('habitatReferences')">
                                Habitat references
                            </label>
                            <div *ngIf="menuItem == 'habitatReferences'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let habitatRef of datasetDetail?.metadata?.habitatReferences" class="tab">
                                        <label class="tab-label no-icon" (click)="navigateToExternal(habitatRef?.soHabitatURI)">
                                            {{habitatRef.soHabitatCode}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab">
                            <input type="checkbox" [checked]="menuItem == 'additionalMetadatas'">
                            <label class="tab-label" (click)="clickOnTab('additionalMetadatas')">
                                Additional metadatas
                            </label>
                            <div *ngIf="menuItem == 'additionalMetadatas'" class="tab-content">
                                <div class="tabs">
                                    <div *ngFor="let additionalMetadata of datasetDetail?.metadata?.additionalMetadatas" class="tab">
                                        <input type="checkbox" [checked]="submenuItem === 'additionalMetadata' + additionalMetadata.name">
                                        <label class="tab-label" (click)="clickOnTabSubmenu('additionalMetadata' + additionalMetadata.name)">
                                            {{additionalMetadata.name}}
                                        </label>
                                        <div class="tab-content" *ngIf="submenuItem === 'additionalMetadata' + additionalMetadata.name">
                                            <div class="h6 text-secundary-color-green-dark mb-0">Value</div>
                                            <div class="mt-0 mb-1"></div>
                                            <div class="mb-1 mt-0">
                                                {{additionalMetadata?.value}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            
            </div>
        </div>
    </div>

</div>